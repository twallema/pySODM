

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>pySODM &mdash; pySODM  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Installation" href="installation.html" />
    <link rel="prev" title="Welcome to pySODM’s documentation" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            pySODM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#quick-installation">Quick installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aim-scope">Aim &amp; scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="#software-structure">Software structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#features">Features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#getting-started">Getting started</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quickstart</a></li>
<li class="toctree-l1"><a class="reference internal" href="workflow.html">Modeling and calibration workflow</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Case studies</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="enzyme_kinetics.html">Enzyme kinetics</a></li>
<li class="toctree-l1"><a class="reference internal" href="influenza_1718.html">Influenza 2017-2018</a></li>
<li class="toctree-l1"><a class="reference internal" href="references.html">Additional references</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">User guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization.html">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="speedup.html">Speeding up models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Developer guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="start_to_collaborate.html">Start to collaborate</a></li>
<li class="toctree-l1"><a class="reference internal" href="guidelines.html">Contribution guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="git_workflow.html">Git workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pySODM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">pySODM</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/introduction.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="pysodm">
<h1>pySODM<a class="headerlink" href="#pysodm" title="Link to this heading">¶</a></h1>
<p><em>Simulating and Optimising Dynamical Models in Python 3</em></p>
<p>Resources: <a class="reference external" href="https://twallema.github.io/pySODM">documentation</a>, <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1877750323002089">peer-reviewed paper</a>, <a class="reference external" href="https://pypi.org/project/pySODM/">pyPI</a></p>
<p><img alt="build" src="https://github.com/twallema/pySODM/actions/workflows/tests.yml/badge.svg" /> <img alt="docs" src="https://github.com/twallema/pySODM/actions/workflows/deploy.yml/badge.svg" /></p>
<section id="quick-installation">
<h2>Quick installation<a class="headerlink" href="#quick-installation" title="Link to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="n">pySODM</span>
</pre></div>
</div>
</section>
<section id="aim-scope">
<h2>Aim &amp; scope<a class="headerlink" href="#aim-scope" title="Link to this heading">¶</a></h2>
<p>All the simulation projects I’ve undertaken over the past six years required me to do most of the following,</p>
<ol class="arabic simple">
<li><p>Translate a real-world transient phenomenon into a set of differential equations called a “model” and integrate it starting from an initial condition.</p></li>
<li><p>The model’s states may be represented by n-dimensional arrays, labeled using coordinates.</p></li>
<li><p>The model’s parameters may have time-dependencies.</p></li>
<li><p>The model’s parameters may have to be sampled from distributions.</p></li>
<li><p>The model’s initial condition may have to be sampled from a distribution.</p></li>
<li><p>The model’s parameters may have to be calibrated to a dataset(s) by defining and optimising a cost function</p></li>
</ol>
<p>all these features required me to wrap bookkeeping code around an ODE solver, typically <code class="docutils literal notranslate"><span class="pre">scipy.solve_ivp</span></code>, and I got tired of recycling the same code over and over again, so I packaged it into pySODM.</p>
<p>Other simulation software exists in Python, but I found most will hold your hand by having you define symbolic transitions, which places a limit on the attainable complexity of a model, making it unfit for academic research. I wanted a piece a software that nicely does all the nasty bookkeeping like keeping track of state sizes, time dependencies on parameters, aligning simulations with datasets etc. and does so in the most <strong>generically applicable</strong> way possible.</p>
</section>
<section id="software-structure">
<h2>Software structure<a class="headerlink" href="#software-structure" title="Link to this heading">¶</a></h2>
<p>To achieve its goal, pySODM bundles a set of low-level interfaces to integrate sets of ODEs (scipy.integrate), simulate stochastic jump processes (Gillespie methods), store n-dimensional temporal data (<code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code>), perform frequentist optimizations of model parameters using Particle Swarm Optimization or the Nelder–Mead Simplex algorithm, and, perform Bayesian inference of model parameters (emcee.EnsembleSampler), all of which were already available in Python 3. pySODM adds a generic way to implement time-dependencies on model parameters, perform consecutive simulations with parameter sampling and/or initial condition sampling.</p>
<img src="_static/figs/flowchart.png" alt="Flowchart of pySODM" width="500">
<p><strong>Figure</strong> Solid boxes depict third-party implementations incorporated in pySODM, while the dashed boxes depict implementations provided by pySODM.</p>
</section>
<section id="features">
<h2>Features<a class="headerlink" href="#features" title="Link to this heading">¶</a></h2>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Workflow</p></th>
<th class="head"><p>Features</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Construct a dynamical model</p></td>
<td><p>Implement systems of coupled differential equations</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Labeled n-dimensional model states, states can have different sizes</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Leverages <code class="docutils literal notranslate"><span class="pre">xarray.Dataset</span></code> to store labeled n-dimensional simulation output</p></td>
</tr>
<tr class="row-odd"><td><p>Simulating the model</p></td>
<td><p>Deterministic (ODE) or stochastic simulation (Jump process)</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><em>Time-dependent parameter functions</em> to vary parameters during the course of a simulation</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p><em>Draw functions</em> to vary model parameters during consecutive simulations</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p><em>Initial condition functions</em> to vary the initial condition during consecutive simulations</p></td>
</tr>
<tr class="row-odd"><td><p>Calibrate the model</p></td>
<td><p>Construct and maximize a posterior probability function</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Automatically aligns data and simulation</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>Nelder-Mead Simplex and Particle Swarm Optimization</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>Bayesian inference with <code class="docutils literal notranslate"><span class="pre">emcee.EnsembleSampler</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>Detailed <a class="reference internal" href="installation.html"><span class="std std-doc">installation instructions</span></a>.</p></li>
<li><p>The <a class="reference internal" href="quickstart.html"><span class="std std-doc">quistart tutorial</span></a> teaches the basics of building and simulating models with n-dimensional labeled states in pySODM. It demonstrates the use of <em>time-dependent parameter functions</em> (TDPFs) to vary model parameters over the course of a simulation and <em>draw functions</em> to vary model parameters during consecutive simulations.</p></li>
<li><p>The <a class="reference internal" href="#worfklow.md"><span class="xref myst">workflow</span></a> tutorial provides a step-by-step introduction to building a mathematical model and calibrating its parameters to a dataset. An SIR disease model is built and the basic reproduction number during an outbreak is determined by calibrating the model to the outbreak data.</p></li>
<li><p>The <a class="reference internal" href="enzyme_kinetics.html"><span class="std std-doc">enzyme kinetics</span></a> and <a class="reference internal" href="influenza_1718.html"><span class="std std-doc">influenza 17-18</span></a> case studies apply the <a class="reference internal" href="workflow.html"><span class="std std-doc">workflow</span></a> to more advanced, real-world problems. In the enzyme kinetics case study, a 1D packed-bed reactor model is implemented in pySODM by reducing the PDEs to a set of coupled ODEs by using the method-of-lines. In the Influenza 17-18 case study, a stochastic, age-structured model for influenza is developped and calibrated to the Influenza incidence data reported by the Belgian Federal Institute of Public Health. These case studies mainly serve to demonstrate pySODM’s capabilities across scientific disciplines and highlight the arbitrarily complex nature of the models that can be built with pySODM. For an academic exposee of pySODM, the Enzyme Kinetics and Influenza 17-18 case studies, checkout our <a class="reference external" href="https://www.sciencedirect.com/science/article/pii/S1877750323002089">peer-reviewed paper</a>.</p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to pySODM’s documentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="installation.html" class="btn btn-neutral float-right" title="Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Tijs Alleman.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>